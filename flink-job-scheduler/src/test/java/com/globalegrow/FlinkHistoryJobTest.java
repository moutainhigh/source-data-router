package com.globalegrow;

import com.globalegrow.util.JacksonUtil;
import org.junit.Test;

import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;

public class FlinkHistoryJobTest {


    String json = "{\"archive\":[{\"path\":\"/jobs/overview\",\"json\":\"{\\\"jobs\\\":[{\\\"jid\\\":\\\"3f8026f0c408708621cdd82f960ad1b8\\\",\\\"name\\\":\\\"zaful-goods-statistics-info-es_1560423159555\\\",\\\"state\\\":\\\"FINISHED\\\",\\\"start-time\\\":1560423165819,\\\"end-time\\\":1560423250243,\\\"duration\\\":84424,\\\"last-modification\\\":1560423250243,\\\"tasks\\\":{\\\"total\\\":2,\\\"created\\\":0,\\\"scheduled\\\":0,\\\"deploying\\\":0,\\\"running\\\":0,\\\"finished\\\":2,\\\"canceling\\\":0,\\\"canceled\\\":0,\\\"failed\\\":0,\\\"reconciling\\\":0}}]}\"},{\"path\":\"/jobs/3f8026f0c408708621cdd82f960ad1b8/config\",\"json\":\"{\\\"jid\\\":\\\"3f8026f0c408708621cdd82f960ad1b8\\\",\\\"name\\\":\\\"zaful-goods-statistics-info-es_1560423159555\\\",\\\"execution-config\\\":{\\\"execution-mode\\\":\\\"PIPELINED\\\",\\\"restart-strategy\\\":\\\"Cluster level default restart strategy\\\",\\\"job-parallelism\\\":1,\\\"object-reuse-mode\\\":false,\\\"user-config\\\":{\\\"file.date\\\":\\\"2019-06-05\\\",\\\"good.dimension\\\":\\\"1\\\",\\\"index-name\\\":\\\"dy_zaful_goods_statistics_1\\\",\\\"filePath\\\":\\\"/user/hive/warehouse/dw_zaful_recommend.db/feature_items_v2_2_ods_info/\\\",\\\"es.source.fields\\\":\\\"item_id,pv_cnt,pv_uv,pv_per_cnt,ipv_cnt,ipv_uv,ipv_per_cnt,bag_cnt,bag_uv,bag_per_cnt,favorite_cnt,favorite_uv,favorite_per_cnt,order_item_cnt,order_uv,order_per_cnt,cvr,uv_cvr,order_cnt,order_income,ctr,uv_ctr,platform\\\"}}}\"},{\"path\":\"/jobs/3f8026f0c408708621cdd82f960ad1b8/checkpoints/config\",\"json\":\"{\\\"errors\\\":[\\\"Checkpointing is not enabled for this job (3f8026f0c408708621cdd82f960ad1b8).\\\"]}\"},{\"path\":\"/jobs/3f8026f0c408708621cdd82f960ad1b8/checkpoints\",\"json\":\"{\\\"errors\\\":[\\\"Checkpointing has not been enabled.\\\"]}\"},{\"path\":\"/jobs/3f8026f0c408708621cdd82f960ad1b8/plan\",\"json\":\"{\\\"plan\\\":{\\\"jid\\\":\\\"3f8026f0c408708621cdd82f960ad1b8\\\",\\\"name\\\":\\\"zaful-goods-statistics-info-es_1560423159555\\\",\\\"nodes\\\":[{\\\"id\\\":\\\"30c025c2021ff24414bdb2035ae70de9\\\",\\\"parallelism\\\":1,\\\"operator\\\":\\\"Data Sink\\\",\\\"operator_strategy\\\":\\\"(none)\\\",\\\"description\\\":\\\"DataSink (com.globalegrow.es.ElasticSearchOutputFormat@5fb97279)\\\",\\\"inputs\\\":[{\\\"num\\\":0,\\\"id\\\":\\\"0d2b27ff576ca760c62c7e56a2cb220d\\\",\\\"ship_strategy\\\":\\\"Forward\\\",\\\"exchange\\\":\\\"pipelined\\\"}],\\\"optimizer_properties\\\":{\\\"global_properties\\\":[{\\\"name\\\":\\\"Partitioning\\\",\\\"value\\\":\\\"RANDOM_PARTITIONED\\\"},{\\\"name\\\":\\\"Partitioning Order\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Uniqueness\\\",\\\"value\\\":\\\"not unique\\\"}],\\\"local_properties\\\":[{\\\"name\\\":\\\"Order\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Grouping\\\",\\\"value\\\":\\\"not grouped\\\"},{\\\"name\\\":\\\"Uniqueness\\\",\\\"value\\\":\\\"not unique\\\"}],\\\"estimates\\\":[{\\\"name\\\":\\\"Est. Output Size\\\",\\\"value\\\":\\\"(unknown)\\\"},{\\\"name\\\":\\\"Est. Cardinality\\\",\\\"value\\\":\\\"1.67 M\\\"}],\\\"costs\\\":[{\\\"name\\\":\\\"Network\\\",\\\"value\\\":\\\"0.0\\\"},{\\\"name\\\":\\\"Disk I/O\\\",\\\"value\\\":\\\"0.0\\\"},{\\\"name\\\":\\\"CPU\\\",\\\"value\\\":\\\"0.0\\\"},{\\\"name\\\":\\\"Cumulative Network\\\",\\\"value\\\":\\\"0.0\\\"},{\\\"name\\\":\\\"Cumulative Disk I/O\\\",\\\"value\\\":\\\"36.95 M\\\"},{\\\"name\\\":\\\"Cumulative CPU\\\",\\\"value\\\":\\\"0.0\\\"}],\\\"compiler_hints\\\":[{\\\"name\\\":\\\"Output Size (bytes)\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Output Cardinality\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Avg. Output Record Size (bytes)\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Filter Factor\\\",\\\"value\\\":\\\"(none)\\\"}]}},{\\\"id\\\":\\\"0d2b27ff576ca760c62c7e56a2cb220d\\\",\\\"parallelism\\\":1,\\\"operator\\\":\\\"Data Source -> FlatMap\\\",\\\"operator_strategy\\\":\\\"(none)<br/> -&gt; FlatMap\\\",\\\"description\\\":\\\"DataSource (at main(GoodsStatisticsInfoEs.java:78) (org.apache.flink.api.java.io.TextInputFormat))<br/> -&gt; FlatMap (FlatMap at main(GoodsStatisticsInfoEs.java:78))\\\",\\\"optimizer_properties\\\":{\\\"global_properties\\\":[{\\\"name\\\":\\\"Partitioning\\\",\\\"value\\\":\\\"RANDOM_PARTITIONED\\\"},{\\\"name\\\":\\\"Partitioning Order\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Uniqueness\\\",\\\"value\\\":\\\"not unique\\\"}],\\\"local_properties\\\":[{\\\"name\\\":\\\"Order\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Grouping\\\",\\\"value\\\":\\\"not grouped\\\"},{\\\"name\\\":\\\"Uniqueness\\\",\\\"value\\\":\\\"not unique\\\"}],\\\"estimates\\\":[{\\\"name\\\":\\\"Est. Output Size\\\",\\\"value\\\":\\\"(unknown)\\\"},{\\\"name\\\":\\\"Est. Cardinality\\\",\\\"value\\\":\\\"1.67 M\\\"}],\\\"costs\\\":[{\\\"name\\\":\\\"Network\\\",\\\"value\\\":\\\"0.0\\\"},{\\\"name\\\":\\\"Disk I/O\\\",\\\"value\\\":\\\"0.0\\\"},{\\\"name\\\":\\\"CPU\\\",\\\"value\\\":\\\"0.0\\\"},{\\\"name\\\":\\\"Cumulative Network\\\",\\\"value\\\":\\\"0.0\\\"},{\\\"name\\\":\\\"Cumulative Disk I/O\\\",\\\"value\\\":\\\"36.95 M\\\"},{\\\"name\\\":\\\"Cumulative CPU\\\",\\\"value\\\":\\\"0.0\\\"}],\\\"compiler_hints\\\":[{\\\"name\\\":\\\"Output Size (bytes)\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Output Cardinality\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Avg. Output Record Size (bytes)\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Filter Factor\\\",\\\"value\\\":\\\"(none)\\\"}]}}]}}\"},{\"path\":\"/jobs/3f8026f0c408708621cdd82f960ad1b8/exceptions\",\"json\":\"{\\\"root-exception\\\":null,\\\"timestamp\\\":null,\\\"all-exceptions\\\":[],\\\"truncated\\\":false}\"},{\"path\":\"/jobs/3f8026f0c408708621cdd82f960ad1b8\",\"json\":\"{\\\"jid\\\":\\\"3f8026f0c408708621cdd82f960ad1b8\\\",\\\"name\\\":\\\"zaful-goods-statistics-info-es_1560423159555\\\",\\\"isStoppable\\\":false,\\\"state\\\":\\\"FINISHED\\\",\\\"start-time\\\":1560423165819,\\\"end-time\\\":1560423250243,\\\"duration\\\":84424,\\\"now\\\":1560423250320,\\\"timestamps\\\":{\\\"CREATED\\\":1560423165819,\\\"SUSPENDING\\\":0,\\\"FINISHED\\\":1560423250243,\\\"RESTARTING\\\":0,\\\"RUNNING\\\":1560423167279,\\\"CANCELED\\\":0,\\\"FAILING\\\":0,\\\"FAILED\\\":0,\\\"RECONCILING\\\":0,\\\"SUSPENDED\\\":0,\\\"CANCELLING\\\":0},\\\"vertices\\\":[{\\\"id\\\":\\\"0d2b27ff576ca760c62c7e56a2cb220d\\\",\\\"name\\\":\\\"CHAIN DataSource (at main(GoodsStatisticsInfoEs.java:78) (org.apache.flink.api.java.io.TextInputFormat)) -> FlatMap (FlatMap at main(GoodsStatisticsInfoEs.java:78))\\\",\\\"parallelism\\\":1,\\\"status\\\":\\\"FINISHED\\\",\\\"start-time\\\":1560423175372,\\\"end-time\\\":1560423230989,\\\"duration\\\":55617,\\\"tasks\\\":{\\\"DEPLOYING\\\":0,\\\"CANCELING\\\":0,\\\"SCHEDULED\\\":0,\\\"RUNNING\\\":0,\\\"RECONCILING\\\":0,\\\"CANCELED\\\":0,\\\"CREATED\\\":0,\\\"FINISHED\\\":1,\\\"FAILED\\\":0},\\\"metrics\\\":{\\\"read-bytes\\\":0,\\\"read-bytes-complete\\\":true,\\\"write-bytes\\\":148635648,\\\"write-bytes-complete\\\":true,\\\"read-records\\\":0,\\\"read-records-complete\\\":true,\\\"write-records\\\":345285,\\\"write-records-complete\\\":true}},{\\\"id\\\":\\\"30c025c2021ff24414bdb2035ae70de9\\\",\\\"name\\\":\\\"DataSink (com.globalegrow.es.ElasticSearchOutputFormat@5fb97279)\\\",\\\"parallelism\\\":1,\\\"status\\\":\\\"FINISHED\\\",\\\"start-time\\\":1560423175790,\\\"end-time\\\":1560423250185,\\\"duration\\\":74395,\\\"tasks\\\":{\\\"DEPLOYING\\\":0,\\\"CANCELING\\\":0,\\\"SCHEDULED\\\":0,\\\"RUNNING\\\":0,\\\"RECONCILING\\\":0,\\\"CANCELED\\\":0,\\\"CREATED\\\":0,\\\"FINISHED\\\":1,\\\"FAILED\\\":0},\\\"metrics\\\":{\\\"read-bytes\\\":148663647,\\\"read-bytes-complete\\\":true,\\\"write-bytes\\\":0,\\\"write-bytes-complete\\\":true,\\\"read-records\\\":345285,\\\"read-records-complete\\\":true,\\\"write-records\\\":0,\\\"write-records-complete\\\":true}}],\\\"status-counts\\\":{\\\"DEPLOYING\\\":0,\\\"CANCELING\\\":0,\\\"SCHEDULED\\\":0,\\\"RUNNING\\\":0,\\\"RECONCILING\\\":0,\\\"CANCELED\\\":0,\\\"CREATED\\\":0,\\\"FINISHED\\\":2,\\\"FAILED\\\":0},\\\"plan\\\":{\\\"jid\\\":\\\"3f8026f0c408708621cdd82f960ad1b8\\\",\\\"name\\\":\\\"zaful-goods-statistics-info-es_1560423159555\\\",\\\"nodes\\\":[{\\\"id\\\":\\\"30c025c2021ff24414bdb2035ae70de9\\\",\\\"parallelism\\\":1,\\\"operator\\\":\\\"Data Sink\\\",\\\"operator_strategy\\\":\\\"(none)\\\",\\\"description\\\":\\\"DataSink (com.globalegrow.es.ElasticSearchOutputFormat@5fb97279)\\\",\\\"inputs\\\":[{\\\"num\\\":0,\\\"id\\\":\\\"0d2b27ff576ca760c62c7e56a2cb220d\\\",\\\"ship_strategy\\\":\\\"Forward\\\",\\\"exchange\\\":\\\"pipelined\\\"}],\\\"optimizer_properties\\\":{\\\"global_properties\\\":[{\\\"name\\\":\\\"Partitioning\\\",\\\"value\\\":\\\"RANDOM_PARTITIONED\\\"},{\\\"name\\\":\\\"Partitioning Order\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Uniqueness\\\",\\\"value\\\":\\\"not unique\\\"}],\\\"local_properties\\\":[{\\\"name\\\":\\\"Order\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Grouping\\\",\\\"value\\\":\\\"not grouped\\\"},{\\\"name\\\":\\\"Uniqueness\\\",\\\"value\\\":\\\"not unique\\\"}],\\\"estimates\\\":[{\\\"name\\\":\\\"Est. Output Size\\\",\\\"value\\\":\\\"(unknown)\\\"},{\\\"name\\\":\\\"Est. Cardinality\\\",\\\"value\\\":\\\"1.67 M\\\"}],\\\"costs\\\":[{\\\"name\\\":\\\"Network\\\",\\\"value\\\":\\\"0.0\\\"},{\\\"name\\\":\\\"Disk I/O\\\",\\\"value\\\":\\\"0.0\\\"},{\\\"name\\\":\\\"CPU\\\",\\\"value\\\":\\\"0.0\\\"},{\\\"name\\\":\\\"Cumulative Network\\\",\\\"value\\\":\\\"0.0\\\"},{\\\"name\\\":\\\"Cumulative Disk I/O\\\",\\\"value\\\":\\\"36.95 M\\\"},{\\\"name\\\":\\\"Cumulative CPU\\\",\\\"value\\\":\\\"0.0\\\"}],\\\"compiler_hints\\\":[{\\\"name\\\":\\\"Output Size (bytes)\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Output Cardinality\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Avg. Output Record Size (bytes)\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Filter Factor\\\",\\\"value\\\":\\\"(none)\\\"}]}},{\\\"id\\\":\\\"0d2b27ff576ca760c62c7e56a2cb220d\\\",\\\"parallelism\\\":1,\\\"operator\\\":\\\"Data Source -> FlatMap\\\",\\\"operator_strategy\\\":\\\"(none)<br/> -&gt; FlatMap\\\",\\\"description\\\":\\\"DataSource (at main(GoodsStatisticsInfoEs.java:78) (org.apache.flink.api.java.io.TextInputFormat))<br/> -&gt; FlatMap (FlatMap at main(GoodsStatisticsInfoEs.java:78))\\\",\\\"optimizer_properties\\\":{\\\"global_properties\\\":[{\\\"name\\\":\\\"Partitioning\\\",\\\"value\\\":\\\"RANDOM_PARTITIONED\\\"},{\\\"name\\\":\\\"Partitioning Order\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Uniqueness\\\",\\\"value\\\":\\\"not unique\\\"}],\\\"local_properties\\\":[{\\\"name\\\":\\\"Order\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Grouping\\\",\\\"value\\\":\\\"not grouped\\\"},{\\\"name\\\":\\\"Uniqueness\\\",\\\"value\\\":\\\"not unique\\\"}],\\\"estimates\\\":[{\\\"name\\\":\\\"Est. Output Size\\\",\\\"value\\\":\\\"(unknown)\\\"},{\\\"name\\\":\\\"Est. Cardinality\\\",\\\"value\\\":\\\"1.67 M\\\"}],\\\"costs\\\":[{\\\"name\\\":\\\"Network\\\",\\\"value\\\":\\\"0.0\\\"},{\\\"name\\\":\\\"Disk I/O\\\",\\\"value\\\":\\\"0.0\\\"},{\\\"name\\\":\\\"CPU\\\",\\\"value\\\":\\\"0.0\\\"},{\\\"name\\\":\\\"Cumulative Network\\\",\\\"value\\\":\\\"0.0\\\"},{\\\"name\\\":\\\"Cumulative Disk I/O\\\",\\\"value\\\":\\\"36.95 M\\\"},{\\\"name\\\":\\\"Cumulative CPU\\\",\\\"value\\\":\\\"0.0\\\"}],\\\"compiler_hints\\\":[{\\\"name\\\":\\\"Output Size (bytes)\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Output Cardinality\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Avg. Output Record Size (bytes)\\\",\\\"value\\\":\\\"(none)\\\"},{\\\"name\\\":\\\"Filter Factor\\\",\\\"value\\\":\\\"(none)\\\"}]}}]}}\"},{\"path\":\"/jobs/3f8026f0c408708621cdd82f960ad1b8/accumulators\",\"json\":\"{\\\"job-accumulators\\\":[],\\\"user-task-accumulators\\\":[],\\\"serialized-user-task-accumulators\\\":{}}\"},{\"path\":\"/jobs/3f8026f0c408708621cdd82f960ad1b8/vertices/0d2b27ff576ca760c62c7e56a2cb220d/subtasktimes\",\"json\":\"{\\\"id\\\":\\\"0d2b27ff576ca760c62c7e56a2cb220d\\\",\\\"name\\\":\\\"CHAIN DataSource (at main(GoodsStatisticsInfoEs.java:78) (org.apache.flink.api.java.io.TextInputFormat)) -> FlatMap (FlatMap at main(GoodsStatisticsInfoEs.java:78))\\\",\\\"now\\\":1560423250346,\\\"subtasks\\\":[{\\\"subtask\\\":0,\\\"host\\\":\\\"bts-datanode06\\\",\\\"duration\\\":63708,\\\"timestamps\\\":{\\\"DEPLOYING\\\":1560423175372,\\\"CANCELING\\\":0,\\\"SCHEDULED\\\":1560423167281,\\\"RUNNING\\\":1560423175438,\\\"RECONCILING\\\":0,\\\"CANCELED\\\":0,\\\"CREATED\\\":1560423167155,\\\"FINISHED\\\":1560423230989,\\\"FAILED\\\":0}}]}\"},{\"path\":\"/jobs/3f8026f0c408708621cdd82f960ad1b8/vertices/30c025c2021ff24414bdb2035ae70de9/subtasktimes\",\"json\":\"{\\\"id\\\":\\\"30c025c2021ff24414bdb2035ae70de9\\\",\\\"name\\\":\\\"DataSink (com.globalegrow.es.ElasticSearchOutputFormat@5fb97279)\\\",\\\"now\\\":1560423250349,\\\"subtasks\\\":[{\\\"subtask\\\":0,\\\"host\\\":\\\"bts-datanode06\\\",\\\"duration\\\":74399,\\\"timestamps\\\":{\\\"DEPLOYING\\\":1560423175790,\\\"CANCELING\\\":0,\\\"SCHEDULED\\\":1560423175786,\\\"RUNNING\\\":1560423175819,\\\"RECONCILING\\\":0,\\\"CANCELED\\\":0,\\\"CREATED\\\":1560423167155,\\\"FINISHED\\\":1560423250185,\\\"FAILED\\\":0}}]}\"},{\"path\":\"/jobs/3f8026f0c408708621cdd82f960ad1b8/vertices/0d2b27ff576ca760c62c7e56a2cb220d/subtasks/0/attempts/0\",\"json\":\"{\\\"subtask\\\":0,\\\"status\\\":\\\"FINISHED\\\",\\\"attempt\\\":0,\\\"host\\\":\\\"bts-datanode06\\\",\\\"start-time\\\":1560423175372,\\\"end-time\\\":1560423230989,\\\"duration\\\":55617,\\\"metrics\\\":{\\\"read-bytes\\\":0,\\\"read-bytes-complete\\\":true,\\\"write-bytes\\\":148635648,\\\"write-bytes-complete\\\":true,\\\"read-records\\\":0,\\\"read-records-complete\\\":true,\\\"write-records\\\":345285,\\\"write-records-complete\\\":true}}\"},{\"path\":\"/jobs/3f8026f0c408708621cdd82f960ad1b8/vertices/30c025c2021ff24414bdb2035ae70de9/subtasks/0/attempts/0\",\"json\":\"{\\\"subtask\\\":0,\\\"status\\\":\\\"FINISHED\\\",\\\"attempt\\\":0,\\\"host\\\":\\\"bts-datanode06\\\",\\\"start-time\\\":1560423175790,\\\"end-time\\\":1560423250185,\\\"duration\\\":74395,\\\"metrics\\\":{\\\"read-bytes\\\":148663647,\\\"read-bytes-complete\\\":true,\\\"write-bytes\\\":0,\\\"write-bytes-complete\\\":true,\\\"read-records\\\":345285,\\\"read-records-complete\\\":true,\\\"write-records\\\":0,\\\"write-records-complete\\\":true}}\"},{\"path\":\"/jobs/3f8026f0c408708621cdd82f960ad1b8/vertices/0d2b27ff576ca760c62c7e56a2cb220d/subtasks/0/attempts/0/accumulators\",\"json\":\"{\\\"subtask\\\":0,\\\"attempt\\\":0,\\\"id\\\":\\\"8a0690f4d2522f86d0c1d2d839152c84\\\",\\\"user-accumulators\\\":[]}\"},{\"path\":\"/jobs/3f8026f0c408708621cdd82f960ad1b8/vertices/30c025c2021ff24414bdb2035ae70de9/subtasks/0/attempts/0/accumulators\",\"json\":\"{\\\"subtask\\\":0,\\\"attempt\\\":0,\\\"id\\\":\\\"96541e2ed7ca452582c125c58bf7cfa3\\\",\\\"user-accumulators\\\":[]}\"},{\"path\":\"/jobs/3f8026f0c408708621cdd82f960ad1b8/vertices/0d2b27ff576ca760c62c7e56a2cb220d/taskmanagers\",\"json\":\"{\\\"id\\\":\\\"0d2b27ff576ca760c62c7e56a2cb220d\\\",\\\"name\\\":\\\"CHAIN DataSource (at main(GoodsStatisticsInfoEs.java:78) (org.apache.flink.api.java.io.TextInputFormat)) -> FlatMap (FlatMap at main(GoodsStatisticsInfoEs.java:78))\\\",\\\"now\\\":1560423250355,\\\"taskmanagers\\\":[{\\\"host\\\":\\\"bts-datanode06:16620\\\",\\\"status\\\":\\\"FINISHED\\\",\\\"start-time\\\":1560423175372,\\\"end-time\\\":1560423230989,\\\"duration\\\":55617,\\\"metrics\\\":{\\\"read-bytes\\\":0,\\\"read-bytes-complete\\\":true,\\\"write-bytes\\\":148635648,\\\"write-bytes-complete\\\":true,\\\"read-records\\\":0,\\\"read-records-complete\\\":true,\\\"write-records\\\":345285,\\\"write-records-complete\\\":true},\\\"status-counts\\\":{\\\"DEPLOYING\\\":0,\\\"CANCELING\\\":0,\\\"SCHEDULED\\\":0,\\\"RUNNING\\\":0,\\\"RECONCILING\\\":0,\\\"CANCELED\\\":0,\\\"CREATED\\\":0,\\\"FINISHED\\\":1,\\\"FAILED\\\":0}}]}\"},{\"path\":\"/jobs/3f8026f0c408708621cdd82f960ad1b8/vertices/30c025c2021ff24414bdb2035ae70de9/taskmanagers\",\"json\":\"{\\\"id\\\":\\\"30c025c2021ff24414bdb2035ae70de9\\\",\\\"name\\\":\\\"DataSink (com.globalegrow.es.ElasticSearchOutputFormat@5fb97279)\\\",\\\"now\\\":1560423250359,\\\"taskmanagers\\\":[{\\\"host\\\":\\\"bts-datanode06:16620\\\",\\\"status\\\":\\\"FINISHED\\\",\\\"start-time\\\":1560423175790,\\\"end-time\\\":1560423250185,\\\"duration\\\":74395,\\\"metrics\\\":{\\\"read-bytes\\\":148663647,\\\"read-bytes-complete\\\":true,\\\"write-bytes\\\":0,\\\"write-bytes-complete\\\":true,\\\"read-records\\\":345285,\\\"read-records-complete\\\":true,\\\"write-records\\\":0,\\\"write-records-complete\\\":true},\\\"status-counts\\\":{\\\"DEPLOYING\\\":0,\\\"CANCELING\\\":0,\\\"SCHEDULED\\\":0,\\\"RUNNING\\\":0,\\\"RECONCILING\\\":0,\\\"CANCELED\\\":0,\\\"CREATED\\\":0,\\\"FINISHED\\\":1,\\\"FAILED\\\":0}}]}\"},{\"path\":\"/jobs/3f8026f0c408708621cdd82f960ad1b8/vertices/0d2b27ff576ca760c62c7e56a2cb220d\",\"json\":\"{\\\"id\\\":\\\"0d2b27ff576ca760c62c7e56a2cb220d\\\",\\\"name\\\":\\\"CHAIN DataSource (at main(GoodsStatisticsInfoEs.java:78) (org.apache.flink.api.java.io.TextInputFormat)) -> FlatMap (FlatMap at main(GoodsStatisticsInfoEs.java:78))\\\",\\\"parallelism\\\":1,\\\"now\\\":1560423250359,\\\"subtasks\\\":[{\\\"subtask\\\":0,\\\"status\\\":\\\"FINISHED\\\",\\\"attempt\\\":0,\\\"host\\\":\\\"bts-datanode06:16620\\\",\\\"start-time\\\":1560423175372,\\\"end-time\\\":1560423230989,\\\"duration\\\":55617,\\\"metrics\\\":{\\\"read-bytes\\\":0,\\\"read-bytes-complete\\\":true,\\\"write-bytes\\\":148635648,\\\"write-bytes-complete\\\":true,\\\"read-records\\\":0,\\\"read-records-complete\\\":true,\\\"write-records\\\":345285,\\\"write-records-complete\\\":true},\\\"start_time\\\":1560423175372}]}\"},{\"path\":\"/jobs/3f8026f0c408708621cdd82f960ad1b8/vertices/30c025c2021ff24414bdb2035ae70de9\",\"json\":\"{\\\"id\\\":\\\"30c025c2021ff24414bdb2035ae70de9\\\",\\\"name\\\":\\\"DataSink (com.globalegrow.es.ElasticSearchOutputFormat@5fb97279)\\\",\\\"parallelism\\\":1,\\\"now\\\":1560423250362,\\\"subtasks\\\":[{\\\"subtask\\\":0,\\\"status\\\":\\\"FINISHED\\\",\\\"attempt\\\":0,\\\"host\\\":\\\"bts-datanode06:16620\\\",\\\"start-time\\\":1560423175790,\\\"end-time\\\":1560423250185,\\\"duration\\\":74395,\\\"metrics\\\":{\\\"read-bytes\\\":148663647,\\\"read-bytes-complete\\\":true,\\\"write-bytes\\\":0,\\\"write-bytes-complete\\\":true,\\\"read-records\\\":345285,\\\"read-records-complete\\\":true,\\\"write-records\\\":0,\\\"write-records-complete\\\":true},\\\"start_time\\\":1560423175790}]}\"}]}";


    @Test
    public void test() throws Exception {
        Map<String, Object> map = JacksonUtil.readValue(json, Map.class);
        //System.out.println(map.get("archive"));
        List<Map<String,Object>> list = (List) map.get("archive");

        Map<String,Object> result = list.stream().filter(map1 -> "/jobs/overview".equals(map1.get("path"))).findFirst().get();

//        System.out.println(list.size());
//        System.out.println(list.get(0));
//        System.out.println(list.get(1));
        System.out.println(result);
        Map<String, Object> jobson = JacksonUtil.readValue((String) result.get("json"), Map.class);
        System.out.println(jobson);
        List<Map<String, Object>> jobs = (List<Map<String, Object>>) jobson.get("jobs");
        System.out.println(jobs.get(0).get("state"));

        //System.out.println(result.get("json"));
        //System.out.println(((Map)result.get("json")).get("state"));

    }

}
